import{_ as a,u as e,s as l,r as s,g as n,o as t,a as c,b as i,c as o,l as u,S as r,d as f,h as d,i as A,e as m,$ as g,f as v,j as h,k as p,m as C,w as k,n as w,p as _,q as x,t as S,v as E,x as I,y as D,z as y,A as B,F as N,B as b,C as G,D as U,E as J,G as L,H as M,I as P,J as V,K,L as Y,M as F,N as Q}from"./index-9136df32.js";const R=a({__name:"index",setup(a){const R=e(),{currentSong:$}=l(R),z=s(!0),O=s(""),T=s([]),q=s([]),W=s([]),H=s(!1),j=s(n("showSinger")||!1),X=s("");function Z(){z.value&&U({title:"提示",content:"确定要强制同步歌曲吗？这将会清空当前列表并重新加载所有歌曲。",success:async a=>{if(a.confirm){o({title:"加载歌曲中...",mask:!0});let a=await u(r.musicDir,!0);T.value=a.filter((a=>A(a.name))),f("SONGS",a),la(),ea(!0),d()}}})}function aa(a){j.value=!j.value,f("showSinger",j.value)}async function ea(a){if(n("SINGERS")&&!a)return void(W.value=n("SINGERS"));let e={path:r.musicDir,name:"search.json"};const{data:l}=await v(e);if(!l||!l.raw_url)return;const s=await h(`${e.path}/${e.name}`,{sign:l.sign,alist_ts:Date.now()});console.log(s);let t=s.singers;t&&t.length&&(W.value=t,f("SINGERS",t))}function la(){q.value=T.value.filter((a=>a.name.toLowerCase().includes(O.value.toLowerCase())||a.path.toLowerCase().includes(O.value.toLowerCase())))}function sa(){O.value="",la()}function na(){let a=q.value.findIndex((a=>`${a.path}${a.name}`==`${$.value.path}${$.value.name}`));J({selector:`#mitem-${Math.max(0,a-5)}`})}function ta(){X.value==="88"+L?(f("pwd",X.value),M({url:"/pages/index/index"})):P({title:"密码错误, 请重新输入"})}return t((a=>{H.value=a.scrollTop>300})),c((async()=>{if(!z.value)return;await i();let a=n("SONGS");a&&a.length||(o({title:"加载歌曲中...初次加载较慢, 请稍后",mask:!0}),a=await u(r.musicDir),f("SONGS",a),d()),T.value=a.filter((a=>A(a.name))),la(),ea()})),m((()=>g("tabClick"))),(a,e)=>{const l=V,s=K,n=w,t=Y,c=F("FloatTool");return p(),C(n,{class:"container pts"},{default:k((()=>[_(" 搜索栏 "),x(n,{class:"search-wrap"},{default:k((()=>[x(n,{class:"search-bar"},{default:k((()=>[x(l,{class:"search-input",placeholder:"关键字搜索音乐, 回车确认",modelValue:S(O),"onUpdate:modelValue":e[0]||(e[0]=a=>E(O)?O.value=a:null),onConfirm:la},null,8,["modelValue"]),I(x(n,{class:"search-icon"},{default:k((()=>[x(s,{class:"iconfont icon-close",onClick:sa})])),_:1},512),[[D,S(O)]]),x(n,{class:"search-icon"},{default:k((()=>[x(s,{class:"iconfont icon-search",onClick:la})])),_:1}),S(W)&&S(W).length?(p(),C(n,{key:0,class:"search-icon",onClick:aa},{default:k((()=>[x(t,{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAAAXNSR0IArs4c6QAAAapJREFUeF7tWkFugzAQ9IqPpD9A2PfmJ01fkuQlTV/S9G5L/KDtPwJboUKLEFagMmaRh7Pxzs7MYrNaUok/lHj+CgTAAYkzgBJI3AD4CKIEUAKJM4ASSNwA/lMgz/NdlmVHIvq63W6Xsiw/p5BVFMWBiB6nrI2xhpnf67q++vCPlkCb/EcfYFVVD/dI0Fq/KaX2MRKbG8OHf5QAY8yJmY+DIBfn3LMv8Bhpc0EuuZ6Iztba0zDGKAFa6xel1GEOAcaYPTM3DhD5zCKgVbNJZtdlM7EEmrL5fUcSE865UbG9x2Cr6FOTBBG9WmuvUxLqvzdl/dJr/vURXBqUpP1xEZKkxhpY4IA1WJcUEw6QpMYaWOCANViXFBMO8KnRv9JWVXW+9yvc7YN+APoBkir8D8us32H0A376gegHMDP6ATIrOhwq3APCcbnNneCAbeoWDjUcEI7Lbe4EB2xTt3Co4QAfl5gPyDLMBwzckfZ8gK+h0JGE+QCllNYa8wGYDwh3REfZCfeAKDQLDgIHCBYnCjQ4IArNgoPAAYLFiQINDohCs+AgcIBgcaJA+wb0lShQ8zotCQAAAABJRU5ErkJggg=="})])),_:1})):_("v-if",!0)])),_:1})])),_:1}),S(j)&&S(W).length?(p(),C(n,{key:0,class:"singers-box"},{default:k((()=>[(p(!0),y(N,null,B(S(W),((a,e)=>(p(),C(n,{class:"singer-item",key:e,onClick:e=>{return l=a,O.value=l,void la();var l}},{default:k((()=>[b(G(a),1)])),_:2},1032,["onClick"])))),128))])),_:1})):_("v-if",!0),S(z)?(p(),C(n,{key:1,class:"search-tip flex jc-sb ai-c"},{default:k((()=>[x(n,null,{default:k((()=>[x(n,{class:"btn",onClick:e[1]||(e[1]=e=>a.$goPage("/pages/setting/index"))},{default:k((()=>[b("设置")])),_:1})])),_:1}),x(n,null,{default:k((()=>[b(" 共"+G(S(q).length)+" / "+G(S(T).length)+" 首歌曲, ",1),x(n,{class:"sync-music",onClick:Z},{default:k((()=>[b("强制同步")])),_:1})])),_:1})])),_:1})):_("v-if",!0),_(" 音乐列表 "),S(z)?(p(),C(n,{key:2,class:"music-list"},{default:k((()=>[(p(!0),y(N,null,B(S(q),((a,e)=>(p(),C(n,{class:Q(["music-item",{on:S($).name==a.name}]),key:e,id:`mitem-${e}`},{default:k((()=>[x(n,{class:"music-info flex-1"},{default:k((()=>[x(n,{class:"music-title line-1"},{default:k((()=>[b(G(a.name),1)])),_:2},1024),x(n,{class:"music-artist line-1"},{default:k((()=>[b(G(a.path),1)])),_:2},1024)])),_:2},1024),x(n,{class:"music-actions"},{default:k((()=>[x(s,{class:"iconfont icon-play",onClick:e=>function(a){P({title:`正在播放：${a.name}`,icon:"none"}),R.addPlay(a,!0)}(a)},null,8,["onClick"]),x(s,{class:"iconfont icon-custom icon-add",onClick:e=>function(a){P({title:`已添加到我的音乐列表：${a.name}`,icon:"none"}),R.addPlay(a,!1)}(a)},null,8,["onClick"])])),_:2},1024)])),_:2},1032,["class","id"])))),128)),S(q)&&S(q).length?_("v-if",!0):(p(),C(n,{key:0,class:"text-center"},{default:k((()=>[b("暂无音乐")])),_:1}))])),_:1})):_("v-if",!0),I(x(c,{showTop:S(H),onLocation:na},null,8,["showTop"]),[[D,S(z)]]),S(z)?_("v-if",!0):(p(),C(n,{key:3,class:"login-wrap flex-center"},{default:k((()=>[x(l,{type:"text",modelValue:S(X),"onUpdate:modelValue":e[2]||(e[2]=a=>E(X)?X.value=a:null),placeholder:"输入密码, 回车确认",onConfirm:ta},null,8,["modelValue"])])),_:1}))])),_:1})}}},[["__scopeId","data-v-78038d26"]]);export{R as default};
